import{ab as B,r as v,ac as D,aP as F,a as N,n as j,o as m,c as f,d as l,w as o,f as U,aj as w,S as h,e as n,ap as C,aT as q,af as d,a4 as P,am as $,I as z,al as M,g as O,i as H,aH as J,h as L,V as S,j as _,aJ as G,br as K,k as p,an as x,ad as Q,ae as W}from"./index.02bdd05e.js";import{V as X,a as Y}from"./VPagination.79d96f83.js";import{V as Z}from"./VInput.ec566b9c.js";import{V as k}from"./VTextField.db45b747.js";import{V as ee}from"./VCheckbox.c024be25.js";import{V as le}from"./VRadio.cda0cd32.js";import{v as te}from"./index.dae76202.js";import"./VSelectionControl.2f2d86ed.js";const V=r=>(Q("data-v-7f97ad91"),r=r(),W(),r),ae={id:"admin-users"},se=V(()=>d("h1",{class:"text-center"},"\u6703\u54E1\u7BA1\u7406",-1)),oe=V(()=>d("thead",null,[d("tr",null,[d("th",null,"\u6703\u54E1\u7DE8\u865F"),d("th",null,"\u4FE1\u7BB1"),d("th",null,"\u5E33\u865F"),d("th",null,"\u662F\u5426\u7BA1\u7406\u54E1"),d("th",null,"\u7BA1\u7406")])],-1)),de=p("\u7DE8\u8F2F"),ie={key:0},ne=V(()=>d("td",{colspan:"4",class:"text-center"},"\u6C92\u6709\u6703\u54E1",-1)),re=[ne],ue=V(()=>d("div",{class:"text-h5 font-weight-bold text-center py-5"},"\u7DE8\u8F2F\u6703\u54E1\u8CC7\u6599",-1)),ce=p("\u522A\u9664\u6B64\u6703\u54E1"),me=p("\u53D6\u6D88"),fe=p("\u78BA\u8A8D\u9001\u51FA"),_e={__name:"UsersView",setup(r){const i=v([]),b=D();F(b);const u=5,c=N(1),R=j(()=>i.slice(c.value*u-u,c.value*u)),e=v({_id:"",account:"",email:"",role:!1,dialog:!1,valid:!1,submitting:!1,idx:-1}),g=v({required(a){return!!a||"\u5FC5\u586B"},email(a){return te.exports.isEmail(a)||"\u4FE1\u7BB1\u683C\u5F0F\u932F\u8AA4"}}),T=(a,t)=>{e._id=i[t]._id,e.email=i[t].email,e.account=i[t].account,e.role=i[t].role,e.idx=t,e.dialog=!0,e.valid=!1,e.submitting=!1},E=async()=>{if(!!e.valid){e.submitting=!0;try{const{data:a}=await w.patch("/users/"+e._id,e);i[e.idx]=a.result,h.fire({title:"success //\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"}),e.dialog=!1}catch(a){h.fire({title:"ERROR //\u5931\u6557",text:a.isAxiosError?a.response.data.message:a.message})}e.submitting=!1}},I=async a=>{const t=await b.delUser(e._id);console.log(t),i.splice(a,1)};return(async()=>{try{const{data:a}=await w.get("/users/all");i.push(...a.result)}catch(a){console.log(a),h.fire({title:"ERROR //\u5931\u6557",text:a.isAxiosError?a.response.data.message:a.message})}})(),(a,t)=>(m(),f("div",ae,[l(U,null,{default:o(()=>[l(n,{cols:"12"},{default:o(()=>[se]),_:1}),l(C),l(n,{cols:"12"},{default:o(()=>[l(q,{"fixed-header":"",height:"300"},{default:o(()=>[oe,d("tbody",null,[(m(!0),f(P,null,$(z(R),(s,A)=>(m(),f("tr",{key:s._id},[d("td",null,x(s._id),1),d("td",null,x(s.email),1),d("td",null,x(s.account),1),d("td",null,[l(le,{olor:"success",modelValue:s.role,"onUpdate:modelValue":y=>s.role=y,disabled:""},null,8,["modelValue","onUpdate:modelValue"])]),d("td",null,[l(_,{onClick:y=>T(s._id,A),variant:"outlined",plain:"",size:"x-small",rounded:"lg"},{default:o(()=>[de]),_:2},1032,["onClick"])])]))),128)),i.length===0?(m(),f("tr",ie,re)):M("",!0)])]),_:1})]),_:1})]),_:1}),l(X,{modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=s=>c.value=s),length:Math.ceil(i.length/u),rounded:"circle",class:"ma-5"},null,8,["modelValue","length"]),l(Y,{modelValue:e.dialog,"onUpdate:modelValue":t[7]||(t[7]=s=>e.dialog=s),persistent:""},{default:o(()=>[l(O,{rounded:"xl"},{default:o(()=>[l(Z,{modelValue:e.valid,"onUpdate:modelValue":t[6]||(t[6]=s=>e.valid=s),onSubmit:H(E,["prevent"])},{default:o(()=>[l(J,null,{default:o(()=>[ue,l(C)]),_:1}),l(L,null,{default:o(()=>[l(S,null,{default:o(()=>[l(U,null,{default:o(()=>[l(n,{cols:"12"},{default:o(()=>[l(k,{label:"\u4FE1\u7BB1",modelValue:e.email,"onUpdate:modelValue":t[1]||(t[1]=s=>e.email=s),rules:[g.required,g.email],type:"text","hide-details":"auto",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),l(n,{cols:"12"},{default:o(()=>[l(k,{label:"\u5E33\u865F",modelValue:e.account,"onUpdate:modelValue":t[2]||(t[2]=s=>e.account=s),rules:[g.required],type:"text","hide-details":"auto",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),l(n,{cols:"12",class:"d-flex justify-space-between align-center"},{default:o(()=>[l(ee,{label:"(\u6253\u52FE)\u7BA1\u7406\u54E1",modelValue:e.role,"onUpdate:modelValue":t[3]||(t[3]=s=>e.role=s),"hide-details":""},null,8,["modelValue"]),l(_,{onClick:t[4]||(t[4]=s=>I(a.idx)),variant:"outlined",size:"x-small",style:{opacity:"0.4"}},{default:o(()=>[ce]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(G,null,{default:o(()=>[l(S,{class:"d-flex"},{default:o(()=>[l(_,{onClick:t[5]||(t[5]=s=>e.dialog=!1),color:"red",variant:"tonal",disadled:e.submitting},{default:o(()=>[me]),_:1},8,["disadled"]),l(K),l(_,{type:"submit",variant:"tonal",loading:e.submitting,color:"green"},{default:o(()=>[fe]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1},8,["modelValue"])]))}};var we=B(_e,[["__scopeId","data-v-7f97ad91"]]);export{we as default};
