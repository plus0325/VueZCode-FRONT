import{ab as D,r as h,ac as F,aP as N,a as $,n as j,o as r,c as p,d as l,w as o,f as w,aj as C,S as x,e as c,ap as S,aT as q,af as d,a4 as z,am as P,I as M,al as O,g as H,i as J,aH as L,h as G,V as R,j as m,aJ as K,br as Q,k as _,an as b,ak as T,ad as W,ae as X}from"./index.cf20b7de.js";import{V as Y,a as Z}from"./VPagination.0d75497c.js";import{V as ee}from"./VInput.6b83ee5d.js";import{V as E}from"./VTextField.1b769b33.js";import{V as le}from"./VCheckbox.3348a51f.js";import{V as te}from"./VRadio.dfe0aa4f.js";import{v as ae}from"./index.dae76202.js";import"./VSelectionControl.c8393a77.js";const V=f=>(W("data-v-64380272"),f=f(),X(),f),se={id:"admin-users"},oe=V(()=>d("h1",{class:"text-center"},"\u6703\u54E1\u7BA1\u7406",-1)),de=V(()=>d("thead",null,[d("tr",null,[d("th",null,"\u6703\u54E1\u7DE8\u865F"),d("th",null,"\u4FE1\u7BB1"),d("th",null,"\u5E33\u865F"),d("th",null,"\u662F\u5426\u7BA1\u7406\u54E1"),d("th",null,"\u7BA1\u7406")])],-1)),ie=_("\u7DE8\u8F2F"),ne=_("\u7DE8\u8F2F"),re={key:0},ue=V(()=>d("td",{colspan:"4",class:"text-center"},"\u6C92\u6709\u6703\u54E1",-1)),ce=[ue],me=V(()=>d("div",{class:"text-h5 font-weight-bold text-center py-5"},"\u7DE8\u8F2F\u6703\u54E1\u8CC7\u6599",-1)),_e=_("\u522A\u9664\u6B64\u6703\u54E1"),fe=_("\u53D6\u6D88"),pe=_("\u78BA\u8A8D\u9001\u51FA"),Ve={__name:"UsersView",setup(f){const i=h([]),y=F();N(y);const u=5,n=$(1),B=j(()=>i.slice(n.value*u-u,n.value*u)),e=h({_id:"",account:"",email:"",role:!1,dialog:!1,valid:!1,submitting:!1,idx:-1}),g=h({required(s){return!!s||"\u5FC5\u586B"},email(s){return ae.exports.isEmail(s)||"\u4FE1\u7BB1\u683C\u5F0F\u932F\u8AA4"}}),k=(s,t)=>{e._id=i[t]._id,e.email=i[t].email,e.account=i[t].account,e.role=i[t].role,e.idx=t,e.dialog=!0,e.valid=!1,e.submitting=!1},I=async()=>{if(!!e.valid){e.submitting=!0;try{const{data:s}=await C.patch("/users/"+e._id,e);i[e.idx]=s.result,x.fire({title:"success //\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"}),e.dialog=!1}catch(s){x.fire({title:"ERROR //\u5931\u6557",text:s.isAxiosError?s.response.data.message:s.message})}e.submitting=!1}},A=async s=>{const t=await y.delUser(e._id);console.log(t),i.splice(s,1)};return(async()=>{try{const{data:s}=await C.get("/users/all");i.push(...s.result)}catch(s){console.log(s),x.fire({title:"ERROR //\u5931\u6557",text:s.isAxiosError?s.response.data.message:s.message})}})(),(s,t)=>(r(),p("div",se,[l(w,null,{default:o(()=>[l(c,{cols:"12"},{default:o(()=>[oe]),_:1}),l(S),l(c,{cols:"12"},{default:o(()=>[l(q,{"fixed-header":"",height:"300"},{default:o(()=>[de,d("tbody",null,[(r(!0),p(z,null,P(M(B),(a,U)=>(r(),p("tr",{key:a._id},[d("td",null,b(a._id),1),d("td",null,b(a.email),1),d("td",null,b(a.account),1),d("td",null,[l(te,{olor:"success",modelValue:a.role,"onUpdate:modelValue":v=>a.role=v,disabled:""},null,8,["modelValue","onUpdate:modelValue"])]),d("td",null,[n.value===1?(r(),T(m,{key:0,onClick:v=>k(a._id,U),variant:"outlined",plain:"",size:"x-small",rounded:"lg"},{default:o(()=>[ie]),_:2},1032,["onClick"])):(r(),T(m,{key:1,onClick:v=>k(a._id,U+(n.value-1)*u),variant:"outlined",plain:"",size:"x-small",rounded:"lg"},{default:o(()=>[ne]),_:2},1032,["onClick"]))])]))),128)),i.length===0?(r(),p("tr",re,ce)):O("",!0)])]),_:1})]),_:1})]),_:1}),l(Y,{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=a=>n.value=a),length:Math.ceil(i.length/u),rounded:"circle",class:"ma-5"},null,8,["modelValue","length"]),l(Z,{modelValue:e.dialog,"onUpdate:modelValue":t[7]||(t[7]=a=>e.dialog=a),persistent:""},{default:o(()=>[l(H,{rounded:"xl"},{default:o(()=>[l(ee,{modelValue:e.valid,"onUpdate:modelValue":t[6]||(t[6]=a=>e.valid=a),onSubmit:J(I,["prevent"])},{default:o(()=>[l(L,null,{default:o(()=>[me,l(S)]),_:1}),l(G,null,{default:o(()=>[l(R,null,{default:o(()=>[l(w,null,{default:o(()=>[l(c,{cols:"12"},{default:o(()=>[l(E,{label:"\u4FE1\u7BB1",modelValue:e.email,"onUpdate:modelValue":t[1]||(t[1]=a=>e.email=a),rules:[g.required,g.email],type:"text","hide-details":"auto",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),l(c,{cols:"12"},{default:o(()=>[l(E,{label:"\u5E33\u865F",modelValue:e.account,"onUpdate:modelValue":t[2]||(t[2]=a=>e.account=a),rules:[g.required],type:"text","hide-details":"auto",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),l(c,{cols:"12",class:"d-flex justify-space-between align-center"},{default:o(()=>[l(le,{label:"(\u6253\u52FE)\u7BA1\u7406\u54E1",modelValue:e.role,"onUpdate:modelValue":t[3]||(t[3]=a=>e.role=a),"hide-details":""},null,8,["modelValue"]),l(m,{onClick:t[4]||(t[4]=a=>A(s.idx)),variant:"outlined",size:"x-small",style:{opacity:"0.4"}},{default:o(()=>[_e]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(K,null,{default:o(()=>[l(R,{class:"d-flex"},{default:o(()=>[l(m,{onClick:t[5]||(t[5]=a=>e.dialog=!1),color:"red",variant:"tonal",disadled:e.submitting},{default:o(()=>[fe]),_:1},8,["disadled"]),l(Q),l(m,{type:"submit",variant:"tonal",loading:e.submitting,color:"green"},{default:o(()=>[pe]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1},8,["modelValue"])]))}};var Ce=D(Ve,[["__scopeId","data-v-64380272"]]);export{Ce as default};
